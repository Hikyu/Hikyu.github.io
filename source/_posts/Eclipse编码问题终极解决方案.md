---
layout: post
title: Eclipse乱码问题终极解决方案
date: 2016-09-20 21:57:08
categories: 工具
tags: 
- Eclipse
---

今天在Eclipse中导入一个新项目的时候，出现了乱码问题。研究一番...

显示乱码的根本原因在于：**文件本身的编码和编辑器打开和编辑文件使用的编码不一致**。当编辑器以不同于文件的编码去解码该文件的时候，就会导致读出来乱码。大部分情况下英文显示正常是因为大部分编码都兼容ASCII，中文则会显示乱码。

## 编辑器显示乱码问题

在Eclipse中，设置编辑器显示和编辑文件所采用编码的方法有四种：

1.Windows->Preference->General->Workspace ：修改整个工作空间

{% asset_img 1.png 全局修改 %}

2.右键Project->Properties->Resource ：修改某个工程

{% asset_img 2.png 工程修改 %}

3.右键文件->Properties ：修改某个文件

{% asset_img 3.png 文件修改 %}

4.Windows->Preference->General->Content types->Default encoding :全局修改某种类型的文件

{% asset_img 4.png 全局文件修改 %}

其中，3的优先级最高。也就是说某个文件被编辑器以哪种编码读取最终是由3中的Text file encoding决定的。一般情况下，如果我们不在3中显示指定编码(选择Other那一项)，Eclipse都会默认使用Default那一项的编码。那么，这个Default的编码又是如何决定的呢？

{% asset_img 5.png 文件修改 %}

注意上图中圈起来的部分：这部分表示了Default采用哪种编码是如何决定的。

<!-- more -->

可能会出现三种情况：

1.determined from content: xxx 

2.determined from content type: xxx

3.inherit from container 

其中：

1表示文件内容本身指定了编码，比如下图。

{% asset_img 6.png 文件修改 %}

Encoding Bit Order Mark，简写为BOM，表明文件本身指定了采用哪种编码方式。编辑器会优先采用这种编码。

2表示采用了针对该文件类型的全局修改，也就是上面提到的第4种设置方式。

3表示继承了上一级指定的编码，这个继承关系就是我们在上面提到的：修改某个文件->修改文件所属的工程->修改整个工作空间。->表示继承于。

上面这3种情况的优先级：1>2>3 。也就是说如果文件本身表明了编码方式，Eclipse优先采用这种编码解码文件。若没有指定，Eclipse会查看该文件类型是否在上面的第4种方式设置中指定了编码，如有则采用该编码。如没有指定，则从下往上搜索继承关系链中指定的编码。（继承关系链：文件->工程->工作空间）

通过上面的分析明白了Eclipse 编辑器选择显示文件所采用编码的原理，相信再次遇到编辑器中的乱码问题都可以找到合适的解决方案。上面的分析不仅仅适用于java文件，同样适用于xml等其他类型文件的乱码问题。

另外一定要注意：**如果通过上面4中方式的某一种修改影响了某个文件的编码，则当你再次编辑完保存该文件时，则采用此时该文件在Eclipse中指定的编码方式保存到本地。**

以上的对乱码问题的分析都是基于通过修改Eclipse编辑器显示文件内容采用的编码，使其与文件本身的编码一致的方式来解决的。还有另一种思路是反过来，修改文件编码与Eclipse显示文件内容所采用的编码一致来解决乱码问题。可以使用文件编码批量转换工具进行批量转换，比如UltraCodingSwitch等。

## Console显示乱码问题

右键要运行的类->Run As->Run Configuratios

{% asset_img 6.png Console编码 %}

可修改上图中Other中的编码来指定显示打印内容的编码。

## 总结

通过以上分析知道了如何在Eclipse中解决乱码的问题。其实文章一开始就说了，显示乱码的根本原因在于：**文件本身的编码和编辑器打开文件使用的编码不一致**。明白了这一点，就算在其他编辑器或编译器中或者任何能够显示文本内容的遇到乱码的情况都能够找到问题的根源，从而解决乱码问题。

至于文件本身的编码，可以通过一定的手段去改变。如通过记事本等工具修改编码后另存为等方式。

Java中输出一段内容到文件可以通过指定流的编码来指定输出字符的编码。

以上