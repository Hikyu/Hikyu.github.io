---
layout: post
title:  "代码规范"
date:   2016-03-29 16:31:55
categories: Tips 
---

>最近写的代码提上去让领导评审，回来给我的建议都是逻辑虽然正确，但代码十分凌乱，命名不规范，看着很不舒服。
 所以决定总结一些规范，以后写代码要注意了~

- ## **命名**

  - 变量，方法，类命名要表义，严格禁止使用 name1, name2 等命名

  - 避免使用数字，但可用 2 代替 to，用 4 代替 for 等，如 go2Clean

  1. 方法

     方法名第一个单词小写，以后每个单词首字母大写。

  2. 类、接口

     所有单词首字母都大写。使用能确切反应该类、接口含义、功能等的词。一般采用名词

  3. 字段、常量

     成员变量、局部变量第一个单词小写，如 userName, instance。

     常量全部大写，在词与词之前用下划线连接，如 MAX_NUMBER。

     代码中禁止使用硬编码，把一些数字或字符串定义成常用量。

- ## **注释**

  1. 成员变量注释

    {% highlight ruby linenos %}
    /** 成员变量注释 */
    protected Object mObject0;

    /**
     * 对于注释多于一行的，采用这种方式来
     * 定义该变量
     */
    private Object mObject4;
    {% endhighlight %}

  2. 方法描述

    {% highlight ruby linenos %}
    /**
      * 方法描述...
      * 
      * @param param1  参数1描述...
      * @param param2  参数2描述...
      * @param paramXX 参数XX描述... （注意：请将参数、描述都对齐）
      */
      public void doSomething(int param1, float param2, String paramXX) {}
    {% endhighlight %}

  3.方法内部注释

    可以使用 /*注释*/ 进行注释，也可以使用 //注释  进行注释，最好所有代码保持一致。但多行连续注释不应该使用后者。
    
    {% highlight ruby linenos %}
    if (a == 2) {
        return TRUE;            /* special case */
    } else {    
        return isprime(a);      /* works only for odd a */}
    {% endhighlight %}


- ## **换行、空格**

  - **换行**

    当代码过长造成阅读困难的时候，就应该考虑代码换行。

    有这么几个原则：

    1.在逗号之后换行

    2.在操作符之前换行

    3.考虑在表达式的外层就换行，而不是内层

    4.新一行的开头应该与前一行的同一级代码对齐

    5.如果以上几个原则使得换行后的表达式过于靠右，那么直接在新行之前插入8个空格代替上面的规则。

    **示例**

    {% highlight ruby linenos %}
    function(longExpression1, longExpression2, longExpression3,         
             longExpression4, longExpression5);

    var = function1(longExpression1,                
                   function2(longExpression2,
                             longExpression3));
    {% endhighlight %}

    在表达式外层换行：

    {% highlight ruby linenos %}
    longName1 = longName2 * (longName3 + longName4 - longName5)
                + 4 * longname6; // PREFER

    longName1 = longName2 * (longName3 + longName4
                             - longName5) + 4 * longname6; // AVOID

    {% endhighlight %}

    插入8个空格的情况

    {% highlight ruby linenos %}
    //INDENT 8 SPACES TO AVOID VERY DEEP INDENTS
    private static synchronized horkingLongMethodName(int anArg,
            Object anotherArg, String yetAnotherArg,
            Object andStillAnother) {    
         ...
    } 

    //条件表达式8空格原则
    if ((condition1 && condition2)
            || (condition3 && condition4)
            ||!(condition5 && condition6)) {
        doSomethingAboutIt();
    }
    {% endhighlight %}

  - **空格**

    1.`{`内的语句，之前插入4个空格。包括函数，if语句，for循环，while循环等。

    2. 操作符左右，大括号`{}`左右，等于号左右都要有一个空格的间距。


- ## **代码技巧**

  - 循环中尽量不要使用try..catch 代码块，应该将其放在最外层

  - if语句中,判断条件尽量不要使用if(!...)的形式，这样只会使代码更加难以理解

  - 循环内不要不断创建对象引用，而应该：

    `Object obj = null;
     for (int i = 0; i <= count; i++) { 
      obj = new Object(); 
     }`

  - 不要在循环条件中重复计算变量，比如：

    `for (int i = 0; i <= obj.size(); i++){...}`

  - 避免使用”魔术数字”,所有的数字值都应该赋予一个有意义的变量，使用这个变量，而不是数字

  - 尽量采用懒加载的策略，即在需要的时候才创建,例如：

    `String str = "aaa";
    if (i == 1) { 
       list.add(str);
    }`

	 建议替换为：

	`if (i == 1) { 
     String str = "aaa"; list.add(str);
   }`

  - 使用同步代码块替代同步方法,同步代码块里只放需要同步的代码

  - 乘(除)2或者2的倍数时，尽量选择移位操作，提高性能

  - 使用&& ,\|\| 操作符时，将首先需要满足的条件置于操作符之前。因为&& 和 \|\| 具有短路性。另外，体会if(e. key==k\|\|k.equals(e.key)) 的细节。判断条件的目的是要求满足k.equals(e.key)。用|\|将（e.key==k）与 k.equals(e.key)连接起来，在性能上有更好的表现。（HashMap源码）

  - 尽量用for each语句代替for循环

- ## **参考**

  [JavaCode Conventions](http://www.oracle.com/technetwork/java/codeconventions-150003.pdf)